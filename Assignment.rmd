---
title: "Data Wrangling - Project"
subtitle: "Insert topic here"
author: "Kunal Ostwal, Martin Huang & Rose Power (Group 2)"
date: 
output:
  html_document:
    number_sections: yes
    self_contained: yes
    theme: flatly  # Style sheet (eg colour and font)
    css: 
      - https://use.fontawesome.com/releases/v5.0.6/css/all.css
    toc: true  # Table of contents
    toc_depth: 3
    toc_float: true
    code_folding: hide
---
<style>
h2 { /* Header 2 */
    font-size: 22px
}
</style>

<style>
h3 { /* Header 3 */
    font-size: 18px
}
</style>

```{r setup, include=FALSE}
library(knitr)
knitr::opts_chunk$set(tidy = FALSE, 
                      message = FALSE,
                      warning = FALSE,
                      echo = TRUE, 
                      fig.width=8,
                      fig.height=6,
                      fig.align = "center",
                      fig.retina = 4)
```



# Executive Summary

Insert a concise (max 200 word) exectutive summary.
It should be a clear, interesting summary of main insights from the report.

# Exploring the Dataset

- Assess Data Provenance
- Domain knowledge
- Explore the data structure
- Look for outliers and missing data

Background to report
Motor vehicle collisions are a major cause of death and injury in New York (City of New York, 2021). This report aims to inform stakeholders of the geospatial patterns of motor vehicle collisions in NYC from 2012-2021. Relevant stakeholders include the New York Police Department (NYPD), NYC Open Data, NYC Government, road safety professionals, and the public.

Assessment of data provenance
The Motor Vehicle Collisions crash data was sourced from NYC OpenData and was provided by the NYPD for public safety purposes (NYC OpenData, 2021). The dataset is classified as free public data and the NYC OpenData website includes thorough information on attribution, creation date, and the data generation process (NYC OpenData, 2021). Data was collected by police officers, who completed a MV-104AN report for all vehicle collisions in NYC (NYC OpenData, 2021). Only very basic data was collected from 1999-2016, and more detailed information was collected from 2016 (NYC OpenData, 2021). An additional limitation is the absence of data prior to 2014, which prevents our ability to analyse trends over a longer period. The data is reliable as it was inputted by trained police officers (NYC OpenData, 2021). However, potential human error must still be considered. The dataset is updated daily and a ‘MVCDataDictionary’ spreadsheet records revision history (NYC OpenData, 2021).

Domain knowledge
NYC is one of the busiest cities in the world. The Cross Bronx Expressway in NYC has been identified as the most congested road in the U.S. (INRIX, 2017). Other highly congested roads in NYC include sections of the George Washington Bridge, Fifth Avenue, and the Lincoln Tunnel (INRIX, 2017). Previous reports indicated that pedestrian collisions were two-thirds deadlier on major roads compared to smaller streets, and Manhattan had four times more pedestrians injured or killed compared to other boroughs (Viola R, Roe M, & Shin H, 2010). For ethics and privacy purposes, the Motor Vehicle Collisions dataset does not reveal confidential information about individuals.

Data structure
The dataset consists of 1.7 million rows and 29 columns. Each row corresponds to a motor vehicle collision, whereas the columns provide details of the collision.

Words: 304 (excluding references)


#CLEANING
```{r}
library(tidyverse) # piping `%>%`, plotting, reading data
library(skimr) # exploratory data summary
library(naniar) # exploratory plots
library(kableExtra) # tables
library(lubridate) # for date variables
library(plotly)
```


```{r}
nyc %>% glimpse()
nyc %>% summary()
vis_miss(nyc, warn_large_data = FALSE)
cleannyc = nyc %>% filter(ZIP.CODE!="Null") 
cleannyc = nyc %>% filter(LATITUDE!="Null")
cleannyc = nyc %>% filter(LONGITUDE!="Null")

cleannyc %>% glimpse()
table(is.na(cleannyc))
cleannyc = na.omit(cleannyc)
vis_miss(cleannyc, warn_large_data = FALSE)

```


```{r}
boxplot(cleannyc[,11:18],cex.axis = 0.6, las = 1, horizontal = TRUE,par(mar= c(5, 10, 4, 2) + 0.1))
```
As we can see in the boxplot above, there are many outliers especially in the number of motorist injured, and number of persons injured. Upon inspection when there was the number of motorist injured, it occurred at 9/9/2013 and is a [Brooklyn Bus Accident](https://www.dnainfo.com/new-york/20130909/bed-stuy/43-people-injured-bed-stuy-when-car-collides-head-on-with-city-bus/) which left 43 people injured when a car collided head on with a bus. And it also turns out that this is the same entry for the outlier in number of persons injured. The reasons why it is in both persons and motorist category is because the 43 people are in the bus, therefore classified as motorists. These outliers without inspection may seem extraordinary and perhaps a possibility of being faulty data collection, however with a further glance they seem to be valid and an important part of our data analysis. In fact in comparison to the mean and median of all these columns, most of the circles shown in the graph are considered outliers. Evidently the median and mean are around 0 accidents, which is expected. Because we have so many entries in data, and the probability of being in an accident is relatively small, this graph is exposed to skewedness, and thus we cannnot say that all these data points greater than 0 are outliers.


```{r}
max(cleannyc$NUMBER.OF.MOTORIST.INJURED)
cleannyc %>% filter(NUMBER.OF.MOTORIST.INJURED == 43)
max(cleannyc$NUMBER.OF.PERSONS.INJURED)
cleannyc %>% filter(NUMBER.OF.PERSONS.INJURED == 43)
```

Even though these outliers are valid, they will affect our aggregate data, by dragging the mean higher than it should be. This is why median is much better than using mean, as it is not as affected by high outliers. We do not care about low outliers as the base is 0 and cannot fall lower. We can also take a look into more details and the affect of these two outliers using the graph below.

```{r}
fig = plot_ly(y = cleannyc$NUMBER.OF.PERSONS.INJURED, type = "box", name = "Number of Persons Injured")
fig = fig %>% add_trace(y = cleannyc$NUMBER.OF.MOTORIST.INJURED, name = "Number of Motorists Injured") %>% layout(title = "Persons Injured and Motorist Injured Outlier Analysis")
fig
```
# Research Question 1 - [INSERT QUESTION HERE]

Here you should

- Address stakeholders
- Wrangle your data to explore your research question
- Create some visualisations
- Provide a conclusion to the research question

# Research Question 2 - [INSERT QUESTION HERE]

Here you should

- Address stakeholders
- Wrangle your data to explore your research question
- Create some visualisations
- Provide a conclusion to the research question

# Reflection on Data Wrangling

Insert your reflection on how data wrangling helped you explore your research questions.
(Don't forget to adjust information at the top of report regarding your name in the author field etc!!)

# References
City of New York. (2021). Vision Zero in New York City. Retrieved from https://www1.nyc.gov/content/visionzero/pages/.

INRIX. (2017). Los Angeles Tops INRIX Global Congestion Ranking 2016 [Press release]. Retrieved from https://inrix.com/press-releases/los-angeles-tops-inrix-global-congestion-ranking/.

NYC OpenData. (2021). Motor Vehicle Collisions - Crashes. Retrieved from https://data.cityofnewyork.us/Public-Safety/Motor-Vehicle-Collisions-Crashes/h9gi-nx95.

Viola R, Roe M, & Shin H. (2010). The New York City Pedestrian Safety Study & Action Plan.  Retrieved from https://www1.nyc.gov/html/dot/downloads/pdf/nyc_ped_safety_study_action_plan.pdf.


